


let currentPage = 1;            ê¸°ë³¸ í˜ì´ì§€ 1 
let canRequest = true;          ì‘ë‹µ ì„±ê³µ 

$(window).scroll(function() {                                   ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ë°œìƒì‹œ 
  let windowHeight = $(window).height();                        ì°½ ë†’ì´
  let documentHeight = $(document).height();                    ë¬¸ì„œ ë†’ì´
  let scrollHeight = $(window).scrollTop();                     ìŠ¤í¬ë¡¤ ë†’ì´ ìˆ˜ì§ ìŠ¤í¬ë¡¤ ë†’ì´

  if (windowHeight + scrollHeight + 100 > documentHeight) {     ì°½ë†’ì´ + ìŠ¤í¬ë¡¤ ë†’ì´ + 100 > ë¬¸ì„œ ë†’ì´ì¼ë•Œ + 100 í•´ì£¼ëŠ” ì´ìœ ëŠ” ì°½ì´ ë”± ê²¹ì¹ ë•Œê°€ ì•„ë‹ˆë¼ ì¡°ê¸ˆ ê°„ê²© ìˆì„ë•Œ ê°€ì ¸ì˜¬ë ¤ê³  
    if (canRequest) {                                           ifë¬¸ ì‹¤í–‰ (ì°¸)
      canRequest = false;                                       ë‹¤ì‹œ ê±°ì§“ìœ¼ë¡œ ë°”ê¾¸ê³  
      getFeeds(currentPage);                                    í˜ì´ì§€ì— ë§ëŠ” ê²Œì‹œê¸€ ê°€ì ¸ì˜´ 
    }
  }
});                                                             ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ë 

getFeeds(currentPage);                                          ê¸°ë³¸ 1í˜ì´ì§€ ê²Œì‹œê¸€ ê°€ì ¸ì˜´ ì²˜ìŒì— í•œí˜ì´ì§€ ê¸€ì€ ê°€ì ¸ì˜´ 

function getFeeds(page) {                                       ê²Œì‹œê¸€ ê°€ì ¸ì˜¤ëŠ” ì´ë²¤íŠ¸ 
  $.ajax({                                                      ë¹„ë™ê¸° í†µì‹  
    type: "get",                                                getë°©ì‹
    url: "items?page=" + page,                                  urlì€ ì´ê±°ë‹¤
    dataType: "json",                                           json ë°ì´í„°ì´ê³  
    success: function (items) {                                 ì„±ê³µì‹œ items 
      appendFeeds(items);                                       ê²Œì‹œê¸€ ì¶”ê°€í•˜ê³  
      currentPage++;                                            í˜ì´ì§€ìˆ˜ ì¦ê°€ 
      canRequest = true;                                        ì°¸ì´ë‹¤. 
    }
  })
}

  function appendFeeds(items) {                                  ê²Œì‹œê¸€ ì¶”ê°€ ì´ë²¤íŠ¸ 
    for (let feed of items) {                                    ë°˜ë³µ itemsë¥¼ í”¼ë“œì— ë°˜ë³µ itemsëŠ” json ë°ì´í„° 

      let content = `
      <!--FEED COMPONENT-->
      <article class="feed">
        <!--top-->
        <div class="new_poster">
          <div class="poster_img">
            <img alt="follower profile image" class="round_img" src="../../../resources/images/img.jpg" />
          </div>
          <a href="#n" class="poster_id txt_id">\${feed.user.name}</a>
          <div class="dropdown-container">
            <svg class="x1lliihq x1n2onr6 x5n08af" fill="currentColor" height="24" role="img" viewBox="0 0 24 24" width="24" id="dropdownToggle">
              <circle cx="12" cy="12" r="1.5"></circle>
              <circle cx="6" cy="12" r="1.5"></circle>
              <circle cx="18" cy="12" r="1.5"></circle>
            </svg>
            <div class="dropdown" id="dropdownMenu1">
              <div class="dropdown-item">ìˆ˜ì •</div>
              <div class="dropdown-item">ì‚­ì œ</div>
            </div>
          </div>
        </div>

        <!--content-->
        <section class="feed_imgs">
          <img alt="ì§€ì •ëœ mediaê°€ ì—†ìŠµë‹ˆë‹¤" src="../../../resources/images/\${feed.mediaUrl}" />
          <div class="interactions">
            <div class="my_emotion">
              <!-- í”¼ë“œ ë‚´ í•˜íŠ¸ ë²„íŠ¼ -->
              <span class="like-btn" id="likeBtn" onclick="toggleLike()">
                          <i class="bi bi-heart large-heart"></i> <!-- ê¸°ë³¸ ë¹ˆ í•˜íŠ¸ ì•„ì´ì½˜ -->
                      </span>
              </button></span>
              <button class="open-popup-btn" onclick="openPopup()">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-chat" viewBox="0 0 16 16">
                  <path d="M2.678 11.894a1 1 0 0 1 .287.801 11 11 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8
                  8 0 0 0 8 14c3.996 0 7-2.807 7-6s-3.004-6-7-6-7 2.808-7 6c0 1.468.617 2.83 1.678 3.894m-.493 3.905a22 22 0 0 1-.713.129c-
                  .2.032-.352-.176-.273-.362a10 10 0 0 0 .244-.637l.003-.01c.248-.
                  72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9 9 0 0 1-2.347-.306c-.
                  52.263-1.639.742-3.468 1.105"/>
                </svg>
              </button>
              <div class="popup-overlay" id="popupOverlay">
                <div class="popup">
                  <div class="popup-left">
                    <img src="../../../resources/images/img.jpg" alt="Post Image">
                  </div>
                  <div class="popup-right">
                    <!-- ë²„íŠ¼ -->
                    <div class="popup-header">
                      <img src="https://via.placeholder.com/40" alt="Profile Picture" class="profile">
                      <div class="username">ìœ ì € ë‹‰ë„¤ì„ ì…ë ¥ë€</div>
                      <div class="more-options" onclick="toggleDropdown()">â‹®</div>
                      <div class="dropdown-menu" id="dropdownMenu2">
                        <div>ìˆ˜ì •</div>
                        <div>ì‚­ì œ</div>
                      </div>
                      <div class="popup-close" onclick="closePopup()">Ã—</div>
                    </div>
                    <div class="popup-content">
                      <p><span class="bold">ì œëª©</span> ë‚´ìš©</p>
                      <p>ë‚´ìš© ì…ë ¥ë€ğŸ”¥</p>
                    </div>
                    <div class="comments-section" id="commentsSection"></div>
                    <!-- íŒì—… ë‚´ í•˜íŠ¸ ë²„íŠ¼ -->
                    <div class="popup-footer">
                      <span class="likes" id="likesCount">ì¢‹ì•„ìš” 0ê°œ</span>
                      <span class="like-btn" id="popupLikeBtn" onclick="toggleLike()">
                  <i class="bi bi-heart small-heart"></i> <!-- íŒì—… ë‚´ í•˜íŠ¸ ì•„ì´ì½˜ -->
              </span>
                    </div>
                    <form>
                      <div class="add-comment">
                      <input type="text" id="commentInput" placeholder="ëŒ“ê¸€ ë‹¬ê¸°...">
                        <button  onclick="addComment()">ê²Œì‹œ</button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>

            <p>
              <a href="#n" class="like_user">
                <img alt="like user image" class="round_img" src="../../../resources/images/img.jpg" />
                <span class="txt_id">ì¢‹ì•„ìš”ëˆ„ë¥¸ ìœ ì €ì´ë¦„</span>
              </a>
              ë‹˜
              <a href="#n" class="like_num txt_id">ì™¸ [ê²Œì‹œê¸€ ì¢‹ì•„ìš” ìˆ˜]ëª…</a>
              ì´ ì¢‹ì•„í•©ë‹ˆë‹¤
            </p>
          </div>
        </section>

        <!--feed text-->
        <section class="feed_txt">
          <a href="#n" class="txt_id">\${feed.title}</a>
          <span> <br/> \${feed.content}</span>
          <a href="#n" class="more">ë”ë³´ê¸°</a>
        </section>


        <!--comment-->
        <div class="comments">
          <div id="listComment" class="list_comment">
            <p class="txt_comment">
                      <span>
                          <a href="#n" class="txt_id"></a>
                          <span>ëŒ“ê¸€ì…ë‹ˆë‹¤ ëŒ“ê¸€ì…ë‹ˆë‹¤ !</span>
                      </span>
              <button id="delete" type="button">ëŒ“ê¸€ì‚­ì œ</button>
            </p>
          </div>
          <form>
            <div class="add-comment">
              <input type="text" id="newComment" placeholder="ëŒ“ê¸€ ë‹¬ê¸°...">
              <button  onclick="addComment()">ê²Œì‹œ</button>
            </div>
          </form>
        </div>

      </article>
    `;

      $("div.feed_board").append(content);                                        <div class:fead_board>ì— append(content)ì¶”ê°€ = ê²Œì‹œê¸€ ì¶”ê°€ 
    }
  }
</script>
